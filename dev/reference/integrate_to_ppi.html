<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate a plan position indicator (ppi) of vertically integrated density
adjusted for range effects — integrate_to_ppi • bioRad</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Calculate a plan position indicator (ppi) of vertically integrated density
adjusted for range effects — integrate_to_ppi"><meta property="og:description" content="Estimates a spatial image of vertically integrated density (vid) based on
all elevation scans of the radar, while accounting for the changing overlap
between the radar beams as a function of range. The resulting ppi is a
vertical integration over the layer of biological scatterers based on all
available elevation scans, corrected for range effects due to partial beam
overlap with the layer of biological echoes (overshooting) at larger
distances from the radar. The methodology is described in detail in
Kranstauber et al. (2020)."><meta property="og:image" content="https://adriaandokter.com/bioRad/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bioRad</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.7.0.9582</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/bioRad.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/rad_aero_19.html">Introductory exercises with bioRad</a>
    </li>
    <li>
      <a href="../articles/range_correction.html">Correction for range effects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adokter/bioRad/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate a plan position indicator (<code>ppi</code>) of vertically integrated density
adjusted for range effects</h1>
    <small class="dont-index">Source: <a href="https://github.com/adokter/bioRad/blob/HEAD/R/integrate_to_ppi.R" class="external-link"><code>R/integrate_to_ppi.R</code></a></small>
    <div class="hidden name"><code>integrate_to_ppi.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimates a spatial image of vertically integrated density (<code>vid</code>) based on
all elevation scans of the radar, while accounting for the changing overlap
between the radar beams as a function of range. The resulting <code>ppi</code> is a
vertical integration over the layer of biological scatterers based on all
available elevation scans, corrected for range effects due to partial beam
overlap with the layer of biological echoes (overshooting) at larger
distances from the radar. The methodology is described in detail in
Kranstauber et al. (2020).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integrate_to_ppi</span><span class="op">(</span></span>
<span>  <span class="va">pvol</span>,</span>
<span>  <span class="va">vp</span>,</span>
<span>  nx <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ny <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4000</span><span class="op">)</span>,</span>
<span>  <span class="va">res</span>,</span>
<span>  quantity <span class="op">=</span> <span class="st">"eta"</span>,</span>
<span>  param <span class="op">=</span> <span class="st">"DBZH"</span>,</span>
<span>  raster <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">lat</span>,</span>
<span>  <span class="va">lon</span>,</span>
<span>  <span class="va">antenna</span>,</span>
<span>  beam_angle <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">crs</span>,</span>
<span>  param_ppi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VIR"</span>, <span class="st">"VID"</span>, <span class="st">"R"</span>, <span class="st">"overlap"</span>, <span class="st">"eta_sum"</span>, <span class="st">"eta_sum_expected"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">4</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  re <span class="op">=</span> <span class="fl">6378</span>,</span>
<span>  rp <span class="op">=</span> <span class="fl">6357</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pvol</dt>
<dd><p>A <code>pvol</code> object.</p></dd>


<dt>vp</dt>
<dd><p>A <code>vp</code> object</p></dd>


<dt>nx</dt>
<dd><p>number of raster pixels in the x (longitude) dimension</p></dd>


<dt>ny</dt>
<dd><p>number of raster pixels in the y (latitude) dimension</p></dd>


<dt>xlim</dt>
<dd><p>x (longitude) range</p></dd>


<dt>ylim</dt>
<dd><p>y (latitude) range</p></dd>


<dt>zlim</dt>
<dd><p>Numeric vector of length two. Altitude range, in m</p></dd>


<dt>res</dt>
<dd><p>numeric vector of length 1 or 2 to set the resolution of the raster (see res).
If this argument is used, arguments <code>nx</code> and <code>ny</code> are ignored. Unit is identical to <code>xlim</code> and <code>ylim</code>.</p></dd>


<dt>quantity</dt>
<dd><p>Character. Profile quantity on which to base range
corrections, either <code>eta</code> or <code>dens</code>.</p></dd>


<dt>param</dt>
<dd><p>reflectivity Character. Scan parameter on which to base range
corrections. Typically the same parameter from which animal densities are
estimated in <code>vp</code>. Either <code>DBZH</code>, <code>DBZV</code>, <code>DBZ</code>, <code>TH</code>, or <code>TV</code>.</p></dd>


<dt>raster</dt>
<dd><p>(optional) RasterLayer with a CRS. When specified this raster topology is used for the output, and nx, ny, res
arguments are ignored.</p></dd>


<dt>lat</dt>
<dd><p>Latitude of the radar, in degrees. If missing taken from <code>pvol</code>.</p></dd>


<dt>lon</dt>
<dd><p>Latitude of the radar, in degrees. If missing taken from <code>pvol</code>.</p></dd>


<dt>antenna</dt>
<dd><p>Numeric. Radar antenna height, in m. Default to antenna height
in <code>vp</code>.</p></dd>


<dt>beam_angle</dt>
<dd><p>Numeric. Beam opening angle in degrees, typically the
angle between the half-power (-3 dB) points of the main lobe.</p></dd>


<dt>crs</dt>
<dd><p>character or object of class CRS. PROJ.4 type description of a Coordinate Reference System (map projection).
When 'NA' (default), an azimuthal equidistant projection with origin at the radar location is used.
To use a WSG84 (lat,lon) projection, use crs="+proj=longlat +datum=WGS84"</p></dd>


<dt>param_ppi</dt>
<dd><p>Character (vector). One or multiple of <code>VIR</code>, <code>VID</code>, <code>R</code>,
<code>overlap</code>, <code>eta_sum</code> or <code>eta_sum_expected</code>.</p></dd>


<dt>k</dt>
<dd><p>Numeric. Standard refraction coefficient.</p></dd>


<dt>re</dt>
<dd><p>Numeric. Earth equatorial radius, in km.</p></dd>


<dt>rp</dt>
<dd><p>Numeric. Earth polar radius, in km.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>ppi</code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function requires:</p><ul><li><p>A polar volume, containing one or multiple scans (<code>pvol</code>).</p></li>
<li><p>A vertical profile (of birds) calculated for that same polar volume (<code>vp</code>).</p></li>
<li><p>A grid defined on the earth's surface, on which we will calculate the range
corrected image (defined by <code>raster</code>, or a combination of <code>nx</code>, <code>ny</code>,<code>res</code>
arguments).</p></li>
</ul><p>The pixel locations on the ground are easily translated into a corresponding
azimuth and range of the various scans (see <code><a href="beam_range.html">beam_range()</a></code>).</p>
<p>For each scan within the polar volume, the function calculates:</p><ul><li><p>the vertical radiation profile for each ground surface pixel for that
particular scan, using <a href="beam_profile.html">beam_profile</a>.</p></li>
<li><p>the reflectivity expected for each ground surface pixel
(\(\eta_{expected}\)), given the vertical profile (of biological
scatterers) and the part of the profile radiated by the beam.
This \(\eta_{expected}\) is simply the average of (linear) <code>eta</code> in the
profile, weighted by the vertical radiation profile.</p></li>
<li><p>the observed eta at each pixel \(\eta_{observed}\), which is converted
form <code>DBZH</code> using function <a href="dbz_to_eta.html">dbz_to_eta</a>, with <code>DBZH</code> the reflectivity
factor measured at the pixel's distance from the radar.</p></li>
<li><p>The vertical radiation profile for each ground surface pixel for that
particular scan, using <code><a href="beam_profile.html">beam_profile()</a></code>.</p></li>
<li><p>The reflectivity expected for each ground surface pixel
(\(\eta_{expected}\)), given the vertical profile (of biological
scatterers) and the part of the profile radiated by the beam. This
\(\eta_{expected}\) is simply the average of (linear) <code>eta</code> in the profile,
weighted by the vertical radiation profile.</p></li>
<li><p>The observed <code>eta</code> at each pixel \(\eta_{observed}\),
which is converted form <code>DBZH</code> using <code><a href="dbz_to_eta.html">dbz_to_eta()</a></code>, with <code>DBZH</code> the
reflectivity factor measured at the pixel's distance from the radar.</p></li>
</ul><p>If one of <code>lat</code> or <code>lon</code> is missing, the extent of the <code>ppi</code> is taken equal
to the extent of the data in the first scan of the polar volume.</p>
<p>To arrive at the final PPI image, the function calculates</p><ul><li><p>the vertically integrated density (<code>vid</code>) and vertically integrated
reflectivity (<code>vir</code>) for the profile, using the function
<a href="integrate_profile.html">integrate_profile</a>.</p></li>
<li><p>the spatial range-corrected PPI for <code>VID</code>, defined as the adjustment
factor image (<code>R</code>), multiplied by the <code>vid</code> calculated for the profile</p></li>
<li><p>the spatial range-corrected PPI for <code>VIR</code>, defined as the adjustment
factor <code>R</code>, multiplied by the <code>vir</code> calculated for the profile.</p></li>
</ul><p>Scans at 90 degree beam elevation (e.g. birdbath scans) are ignored.</p>
<p>#' @seealso</p><ul><li><p><code><a href="summary.ppi.html">summary.ppi()</a></code></p></li>
<li><p><code><a href="beam_profile.html">beam_profile()</a></code></p></li>
<li><p><code><a href="beam_range.html">beam_range()</a></code></p></li>
<li><p><code><a href="integrate_profile.html">integrate_profile()</a></code></p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Kranstauber B, Bouten W, Leijnse H, Wijers B, Verlinden L, Shamoun-Baranes
J, Dokter AM (2020) High-Resolution Spatial Distribution of Bird Movements
Estimated from a Weather Radar Network. Remote Sensing 12 (4), 635.
<a href="https://doi.org/10.3390/rs12040635" class="external-link">doi:10.3390/rs12040635</a></p></li>
<li><p>Buler JJ &amp; Diehl RH (2009) Quantifying bird density during migratory
stopover using weather surveillance radar. IEEE Transactions on Geoscience
and Remote Sensing 47: 2741-2751.
<a href="https://doi.org/10.1109/TGRS.2009.2014463" class="external-link">doi:10.1109/TGRS.2009.2014463</a></p></li>
</ul><ul><li><p>Kranstauber B, Bouten W, Leijnse H, Wijers B, Verlinden L, Shamoun-Baranes
J, Dokter AM (2020) High-Resolution Spatial Distribution of Bird
Movements Estimated from a Weather Radar Network. Remote Sensing 12 (4),
635. <a href="https://doi.org/10.3390/rs12040635" class="external-link">doi:10.3390/rs12040635</a></p></li>
<li><p>Buler JJ &amp; Diehl RH (2009) Quantifying bird density during migratory
stopover using weather surveillance radar. IEEE Transactions on Geoscience
and Remote Sensing 47: 2741-2751.
<a href="https://doi.org/10.1109/TGRS.2009.2014463" class="external-link">doi:10.1109/TGRS.2009.2014463</a></p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Locate and read the polar volume example file</span></span></span>
<span class="r-in"><span><span class="va">pvolfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"volume.h5"</span>, package <span class="op">=</span> <span class="st">"bioRad"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load polar volume</span></span></span>
<span class="r-in"><span><span class="va">pvol</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_pvolfile.html">read_pvolfile</a></span><span class="op">(</span><span class="va">pvolfile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read the corresponding vertical profile example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">example_vp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the range-corrected ppi on a 50x50 pixel raster</span></span></span>
<span class="r-in"><span><span class="va">ppi</span> <span class="op">&lt;-</span> <span class="fu">integrate_to_ppi</span><span class="op">(</span><span class="va">pvol</span>, <span class="va">example_vp</span>, nx <span class="op">=</span> <span class="fl">50</span>, ny <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the vertically integrated reflectivity (VIR) using a</span></span></span>
<span class="r-in"><span><span class="co"># 0-2000 cm^2/km^2 color scale</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppi</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integrate_to_ppi-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Calculate the range-corrected ppi on finer 2000m x 2000m pixel raster</span></span></span>
<span class="r-in"><span><span class="va">ppi</span> <span class="op">&lt;-</span> <span class="fu">integrate_to_ppi</span><span class="op">(</span><span class="va">pvol</span>, <span class="va">example_vp</span>, res <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the vertically integrated density (VID) using a</span></span></span>
<span class="r-in"><span><span class="co"># 0-200 birds/km^2 color scale</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppi</span>, param <span class="op">=</span> <span class="st">"VID"</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Download a basemap and map the ppi</span></span></span>
<span class="r-in"><span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="download_basemap.html">download_basemap</a></span><span class="op">(</span><span class="va">ppi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="map.html">map</a></span><span class="op">(</span><span class="va">ppi</span>, <span class="va">bm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The ppi can also be projected on a user-defined raster, as follows:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First define the raster</span></span></span>
<span class="r-in"><span><span class="va">template_raster</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/extent.html" class="external-link">extent</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">56</span>, <span class="fl">57</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  crs <span class="op">=</span> <span class="fu">sp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Project the ppi on the defined raster</span></span></span>
<span class="r-in"><span><span class="va">ppi</span> <span class="op">&lt;-</span> <span class="fu">integrate_to_ppi</span><span class="op">(</span><span class="va">pvol</span>, <span class="va">example_vp</span>, raster <span class="op">=</span> <span class="va">template_raster</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the raster data from the ppi object</span></span></span>
<span class="r-in"><span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html" class="external-link">brick</a></span><span class="op">(</span><span class="va">ppi</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the range-corrected ppi on an even finer 500m x 500m pixel raster,</span></span></span>
<span class="r-in"><span><span class="co"># cropping the area up to 50000 meter from the radar</span></span></span>
<span class="r-in"><span><span class="va">ppi</span> <span class="op">&lt;-</span> <span class="fu">integrate_to_ppi</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">pvol</span>, <span class="va">example_vp</span>, res <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50000</span>, <span class="fl">50000</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50000</span>, <span class="fl">50000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppi</span>, param <span class="op">=</span> <span class="st">"VID"</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://adriaandokter.com" class="external-link">Adriaan M. Dokter</a>, <a href="https://twitter.com/peterdesmet" class="external-link">Peter Desmet</a>, <a href="https://twitter.com/SVanHoey" class="external-link">Stijn Van Hoey</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '482e77c49caf113078e572738762cf40',
    indexName: 'biorad',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

