<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate sunrise or sunset for a time and place — sunrise_sunset • bioRad</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate sunrise or sunset for a time and place — sunrise_sunset"><meta name="description" content="Calculate sunrise or sunset for a time and place"><meta property="og:description" content="Calculate sunrise or sunset for a time and place"><meta property="og:image" content="http://adriaandokter.com/bioRad/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bioRad</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bioRad.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rad_aero_22.html">Introductory exercises with bioRad</a></li>
    <li><a class="dropdown-item" href="../articles/range_correction.html">Correction for range effects</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/adokter/bioRad/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate sunrise or sunset for a time and place</h1>
      <small class="dont-index">Source: <a href="https://github.com/adokter/bioRad/blob/0.10.0/R/sunrise_sunset.R" class="external-link"><code>R/sunrise_sunset.R</code></a></small>
      <div class="d-none name"><code>sunrise_sunset.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate sunrise or sunset for a time and place</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sunrise</span><span class="op">(</span><span class="va">date</span>, <span class="va">lon</span>, <span class="va">lat</span>, elev <span class="op">=</span> <span class="op">-</span><span class="fl">0.268</span>, tz <span class="op">=</span> <span class="st">"UTC"</span>, force_tz <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sunset</span><span class="op">(</span><span class="va">date</span>, <span class="va">lon</span>, <span class="va">lat</span>, elev <span class="op">=</span> <span class="op">-</span><span class="fl">0.268</span>, tz <span class="op">=</span> <span class="st">"UTC"</span>, force_tz <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-date">date<a class="anchor" aria-label="anchor" href="#arg-date"></a></dt>
<dd><p>POSIXct. Date interpretable by <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">base::as.Date()</a></code>.</p></dd>


<dt id="arg-lon">lon<a class="anchor" aria-label="anchor" href="#arg-lon"></a></dt>
<dd><p>Numeric. Longitude in decimal degrees.</p></dd>


<dt id="arg-lat">lat<a class="anchor" aria-label="anchor" href="#arg-lat"></a></dt>
<dd><p>Numeric. Latitude in decimal degrees.</p></dd>


<dt id="arg-elev">elev<a class="anchor" aria-label="anchor" href="#arg-elev"></a></dt>
<dd><p>Numeric. Sun elevation in degrees.</p></dd>


<dt id="arg-tz">tz<a class="anchor" aria-label="anchor" href="#arg-tz"></a></dt>
<dd><p>Character. Time zone of <code>date</code>, ignored if <code>date</code> already has an
associated time zone.</p></dd>


<dt id="arg-force-tz">force_tz<a class="anchor" aria-label="anchor" href="#arg-force-tz"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the output is converted to the timezone
set by <code>tz</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The moment of sunrise or sunset for the date set by <code>date</code>and time zone as specified
(by <code>date</code> and <code>tz</code>) or in UTC if not specified.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The day for which sunrise and sunset are calculated is given by the input date.
Sunrise and sunset are calculated relative to the moment of solar noon for that date,
i.e. the first sunrise before the moment of solar noon, and the first sunset after the
moment of solar noon. Therefore, depending on the timezone provided, it is possible that
the nearest sunrise prior to solar noon occurs a day earlier than the input date.
Similarly, sunset may occur a day later than the input date. See examples for details.</p>
<p>The angular diameter of the sun is about 0.536 degrees,
therefore the moment of sunrise/sunset corresponds to half that elevation
at -0.268 degrees.</p>
<p>This is a convenience function mapping to <a href="https://rdrr.io/pkg/suntools/man/crepuscule.html" class="external-link">suntools::crepuscule</a>.</p>
<p>Approximate astronomical formula are used, therefore the moment of
sunrise / sunset may be off by a few minutes</p>
<p>If <code>force_tz</code> is <code>TRUE</code>, the output is converted to the timezone
set by <code>tz</code></p>
<p>The day for which sunrise and sunset are calculated is given by the input date.
Sunrise and sunset are calculated relative to the moment of solar noon for that date,
i.e. the first sunrise before the moment of solar noon, and the first sunset after the
moment of solar noon. Therefore, depending on the timezone provided, it is possible that
the nearest sunrise prior to solar noon occurs a day earlier than the input date.
Similarly, sunset may occur a day later than the input date. See examples for details.</p>
<p>The angular diameter of the sun is about 0.536 degrees,
therefore the moment of sunrise/sunset corresponds to half that elevation
at -0.268 degrees.</p>
<p>This is a convenience function mapping to <a href="https://rdrr.io/pkg/suntools/man/crepuscule.html" class="external-link">suntools::crepuscule</a>.</p>
<p>Approximate astronomical formula are used, therefore the moment of
sunrise / sunset may be off by a few minutes</p>
<p>If <code>force_tz</code> is <code>TRUE</code>, the output is converted to the timezone
set by <code>tz</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># sunrise in the Netherlands</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="fl">5</span>, <span class="fl">53</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 07:58:17 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sunset in the Netherlands</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="fl">5</span>, <span class="fl">53</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 15:28:31 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># civil twilight in Ithaca, NY</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="op">-</span><span class="fl">76.5</span>, <span class="fl">42.4</span>, elev <span class="op">=</span> <span class="op">-</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 12:03:29 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># next sunset in South Dakota, USA</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-11-15"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-11-15 22:58:56 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beware that some days have two sunsets, or</span></span></span>
<span class="r-in"><span><span class="co"># two sunrises! E.g. on 5 Oct (local timezone) at</span></span></span>
<span class="r-in"><span><span class="co"># this location  sunset is actually on the 6 Oct</span></span></span>
<span class="r-in"><span><span class="co"># in UTC time zone, i.e. the next day</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-10-5"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-06 00:00:46 UTC"</span>
<span class="r-in"><span><span class="co"># One day later, sunset is again on 6 Oct:</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-10-6"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-06 23:58:56 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># working in local time zones typically avoids such ambiguities:</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-05"</span>,tz<span class="op">=</span><span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-06 02:11:19 UTC"</span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-06"</span>,tz<span class="op">=</span><span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-07 02:12:00 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use force_tz to force output to a specific time zone, by default UTC:</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-05"</span>,tz<span class="op">=</span><span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span>, force_tz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-06 02:11:19 UTC"</span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-06"</span>,tz<span class="op">=</span><span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span>, force_tz<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-07 02:12:00 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Also beware of jumps in sunrise and sunset date with longitude:</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-11-01"</span>, <span class="fl">100</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-11-01 00:01:50 UTC"</span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-11-01"</span>, <span class="fl">102</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-31 23:53:50 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sunrise in the Netherlands</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="fl">5</span>, <span class="fl">53</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 07:58:17 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sunset in the Netherlands</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="fl">5</span>, <span class="fl">53</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 15:28:31 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Civil twilight in Ithaca, NY</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="op">-</span><span class="fl">76.5</span>, <span class="fl">42.4</span>, elev <span class="op">=</span> <span class="op">-</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-01-01 12:03:29 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next sunset in South Dakota, USA</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-11-15"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-11-15 22:58:56 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beware that some days have two sunsets, or two sunrises! E.g. on 5 Oct</span></span></span>
<span class="r-in"><span><span class="co"># (local timezone) at this location sunset is actually on the 6 Oct in UTC,</span></span></span>
<span class="r-in"><span><span class="co"># i.e. the next day</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-10-5"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-06 00:00:46 UTC"</span>
<span class="r-in"><span><span class="co"># One day later, sunset is again on 6 Oct</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="st">"2016-10-6"</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-06 23:58:56 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Working in local time zones typically avoids such ambiguities</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-05"</span>, tz <span class="op">=</span> <span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-06 02:11:19 UTC"</span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-06"</span>, tz <span class="op">=</span> <span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-07 02:12:00 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use force_tz to force output to a specific time zone, by default UTC</span></span></span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-05"</span>, tz <span class="op">=</span> <span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span>, force_tz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-06 02:11:19 UTC"</span>
<span class="r-in"><span><span class="fu">sunset</span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html" class="external-link">as_datetime</a></span><span class="op">(</span><span class="st">"2016-06-06"</span>, tz <span class="op">=</span> <span class="st">"America/Chicago"</span><span class="op">)</span>, <span class="op">-</span><span class="fl">98</span>, <span class="fl">45</span>, force_tz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-06-07 02:12:00 UTC"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Also beware of jumps in sunrise and sunset date with longitude</span></span></span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-11-01"</span>, <span class="fl">100</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-11-01 00:01:50 UTC"</span>
<span class="r-in"><span><span class="fu">sunrise</span><span class="op">(</span><span class="st">"2016-11-01"</span>, <span class="fl">102</span>, <span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2016-10-31 23:53:50 UTC"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adriaan M. Dokter, Peter Desmet, Bart Kranstauber, Cecilia Nilsson, Stijn Van Hoey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

